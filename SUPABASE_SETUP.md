# Supabase Setup

이 프로젝트는 회의 예약(캘린더) 기능을 위해 Supabase를 사용합니다. 아래 단계를 따라 백엔드를 구성해주세요.

## 1. Supabase 프로젝트 생성
1. [Supabase](https://supabase.com/)에 가입하고 새 프로젝트를 생성합니다.
2. 프로젝트 대시보드에서 **Project Settings → API**로 이동하여 다음 값을 확인합니다.
   - `Project URL`
   - `service_role` 키 (서버 전용 보안 키)

## 2. 데이터베이스 테이블 만들기
SQL Editor에서 다음 스키마를 실행하여 `meetings` 테이블을 생성합니다.

```sql
create table if not exists public.meetings (
    id bigint generated by default as identity primary key,
    session_name text not null,
    host_name text not null,
    start_time timestamptz not null,
    created_at timestamptz not null default timezone('utc', now())
);

create index if not exists meetings_start_time_idx on public.meetings (start_time);
```

## 3. 환경 변수 설정
루트 디렉터리에 있는 `.env` 파일(또는 배포 환경의 비밀 변수)에 아래 값을 추가합니다.

```bash
ZOOM_SDK_KEY=your_zoom_sdk_key
ZOOM_SDK_SECRET=your_zoom_sdk_secret
# 아래 둘 중 하나를 설정하세요 (Meeting SDK 호스트 참가 시 필수)
# 1) Server-to-Server OAuth 자격 증명
# ZOOM_ACCOUNT_ID=your_zoom_account_id
# ZOOM_CLIENT_ID=your_zoom_oauth_client_id
# ZOOM_CLIENT_SECRET=your_zoom_oauth_client_secret
# 2) 또는 Zoom JWT API Key/Secret (레거시 계정)
# ZOOM_API_KEY=your_zoom_api_key
# ZOOM_API_SECRET=your_zoom_api_secret
BACKEND_BASE_URL=http://localhost:4000
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
```

> ⚠️ `SUPABASE_SERVICE_ROLE_KEY`는 **서버에서만** 사용해야 합니다. 이미 제공된 Express 서버(`token-server.js`)는 이 키를 안전하게 사용하여 Supabase REST API를 호출합니다.

## 4. 백엔드 서버 실행
루트에서 아래 명령어로 토큰/예약 서버를 실행합니다.

```bash
npm install
npm run token-server
```

서버가 실행되면 `http://localhost:4000`에서 토큰 발급 및 회의 예약 API를 사용할 수 있습니다.

## 5. Electron 앱 환경 변수
`zoom-video-app/.env` 파일에 다음 값을 추가하여 렌더러에 환경 변수를 전달합니다.

```bash
ZOOM_SDK_KEY=your_zoom_sdk_key
ZOOM_SDK_SECRET=your_zoom_sdk_secret
BACKEND_BASE_URL=http://localhost:4000
```

이제 애플리케이션에서 회의 생성, 참여, 화면 공유, 캘린더 조회 기능을 사용할 수 있습니다.
